<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mise à jour</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0064FA 0%, #0050CC 100%);
      color: white;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      -webkit-app-region: drag;
      user-select: none;
    }
    .container {
      text-align: center;
      padding: 40px;
    }
    .icon {
      width: 64px;
      height: 64px;
      margin-bottom: 24px;
    }
    .icon svg {
      width: 100%;
      height: 100%;
      fill: white;
    }
    .spinner {
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    h1 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .status {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 24px;
    }
    .progress-container {
      width: 280px;
      height: 6px;
      background: rgba(255,255,255,0.3);
      border-radius: 3px;
      overflow: hidden;
      margin: 0 auto;
    }
    .progress-bar {
      height: 100%;
      background: white;
      border-radius: 3px;
      transition: width 0.3s ease;
      width: 0%;
    }
    .percent {
      font-size: 13px;
      margin-top: 12px;
      opacity: 0.8;
    }
    .version {
      font-size: 12px;
      opacity: 0.6;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="icon">
      <svg class="spinner" viewBox="0 0 24 24">
        <path d="M12 4V2A10 10 0 0 0 2 12h2a8 8 0 0 1 8-8z"/>
      </svg>
    </div>
    <h1 id="title">Mise à jour en cours</h1>
    <p class="status" id="status">Vérification...</p>
    <div class="progress-container">
      <div class="progress-bar" id="progress"></div>
    </div>
    <p class="percent" id="percent"></p>
    <p class="version" id="version"></p>
  </div>

  <script>
    const { ipcRenderer } = require('electron')

    const titleEl = document.getElementById('title')
    const statusEl = document.getElementById('status')
    const progressEl = document.getElementById('progress')
    const percentEl = document.getElementById('percent')
    const versionEl = document.getElementById('version')

    ipcRenderer.on('update-status', (event, data) => {
      switch (data.status) {
        case 'checking':
          statusEl.textContent = 'Vérification des mises à jour...'
          break
        case 'available':
          statusEl.textContent = 'Nouvelle version disponible'
          versionEl.textContent = `Version ${data.version}`
          break
        case 'downloading':
          statusEl.textContent = 'Téléchargement en cours...'
          progressEl.style.width = `${data.percent}%`
          percentEl.textContent = `${Math.round(data.percent)}%`
          break
        case 'downloaded':
          titleEl.textContent = 'Installation'
          statusEl.textContent = 'Installation en cours...'
          progressEl.style.width = '100%'
          percentEl.textContent = 'Redémarrage imminent'
          break
        case 'error':
          titleEl.textContent = 'Erreur'
          statusEl.textContent = data.message || 'Une erreur est survenue'
          break
      }
    })
  </script>
</body>
</html>
